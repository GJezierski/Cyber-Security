# Static and Dynamic Malware Analysis Lab

## Reading Assignment
### Introduction

In this lab, students will perform static and dynamic malware analysis. Analyzing malware is important because an analyst will want to know what actions the malware is performing on the system as well as on the network. The hash value of the malware can tell you if the malware has been widely used before. Dynamic analysis involves executing the malware and seeing how it behaves, whereas static analysis just involves examining the information contained within the file. Figure 1 shows the lab topology for this lab.

In this lab, you will learn to:

Perform static malware analysis
Perform dynamic malware analysis

### Introduction To Hashing

Hashing is the process of taking in a stream of plaintext and transforming the data into a hashed text using a hashing algorithm. You can use the hash to make sure that a message is not modified during transmission. Figure 2 shows the hashing process.

Hashed images are commonly used in forensics investigations. Hashing is also used on files, passwords, and other pieces of data.

A hashing algorithm is what takes the data and creates a hash. There are many hashing algorithms that exist such as MD5 (Message Digest 5), SHA-1 (Secure Hashing Algorithm 1), SHA-256, SHA-384, and SHA-512. Let’s look at MD5, which is one of most insecure algorithms that exist today. The message digest algorithm (MD5) is an algorithm that creates 128-bit outputs. Although they are extremely rare, collisions could occur with an MD5 hash which means that two or more different inputs can result in the same 128-bit hash. The next algorithm is the Secure Hash Algorithm 1, SHA-1, which creates 160-bit outputs. SHA-256 has a length of 256 bits or 64 hex characters which is 2^256 combinations. SHA-384 is 384 bits long which is 2^384 combinations, and SHA512 is 512 bits and is 2^512 combinations.

Let us take a closer look at hashing works. Figure 3 illustrates the hashing process.

So, a hashing algorithm takes a message/data and breaks it up in blocks depending upon the hashing function you are using. If the data is not a multiple of the hashing blocks (e.g., 256-bit block for SHA-256), then the last block will be padded. Each block is run through the algorithm depending on the number of blocks in the message/data. The first block runs through the algorithm and then it runs through the algorithm with the second block, etc., until you get a hash.

### Introduction To Malware

Malware, also known a malicious software, is a piece of software that does harm to a computer, a network, server, etc. There are a range of strategies that can be used to control against malware such as antivirus software, firewalls, intrusion detection and prevention systems, and others. But, even if you followed picture-perfect defense-in-depth strategies, your systems can still be hacked as you will see in this lab. All it takes is a weakness in your protections to allow unauthorized access to systems. This reading assignment will review some common types of malware. This lab demonstrates static and dynamic malware analysis. Static malware analysis takes a virus and determines what it is using the browser and a web site called VirusTotal. With dynamic malware analysis, unlike static analysis, we will run the malware and try to determine the behavior. With Wireshark and other tools, we can try to determine what IP address and port the malware beacons to if it has that capability.

### Viruses

A virus is a type of malware that typically hides itself into another piece of software that can quickly replicate itself into other applications and files once it runs to create havoc on a system. An antivirus software’s job is to counteract virus by scanning and removing them on systems.

### Ransomware

Ransomware is a type of malware that infects systems by encrypting its files. Then, the attackers will usually demand a ransom to unencrypt the files on the system, payable in Bitcoin using a one-way transaction. Antivirus software and a good backup schedule and policy can be used to help counteract this type of malware.

### Trojan Horse

A trojan horse is another type of malware the masquerades as a valid application to persuade a victim to install it and/or launch it. Trojans spread through social engineering and brute force hacking of systems.

### Rootkits

Rootkits are yet another type of malware that is installed on a system. Rootkits are infamous for evading detection, and they can do lots of harm to a system.

### Backdoors

A backdoor is a type of malware that allows for bypassing the normal authentication procedures on systems.

### VirusTotal

VirusTotal is a web site that provides information about malware and viruses. Figure 4 shows an example of a virus result from VirusTotal.

### Capturing And Examining Traffic

A sniffer can be used to examine network traffic. Often, a Linux system will be used to capture traffic using a built-in tool like tcpdump. The sniffer is connected to a switch and runs in promiscuous mode. Promiscuous mode tells the interfaces to allow for packet sniffing. When a port is in promiscuous mode (also called a SPAN port), it can see all of the broadcast, multicast, and unicast traffic between devices. Software programs like Wireshark can be used on a device connected to a SPAN port to sniff all of the network traffic. Wireshark is a powerful tool that allows you to analyze and capture network traffic. Figure 5 shows the Graphical User Interface (GUI) for Wireshark. You open a captured network traffic file, and the first step is to filter the traffic which is called a DisplayFilter. A DisplayFilter allows you to only isolate different types of network traffic. You can filter on items like the tcp.port number, the protocol type (like FTP or telnet), Internet Protocol (IP) addresses, Media Access Control (MAC) addresses, as well as many other available filter types. For more information on DisplayFilters, click the following: link. You will use different DisplayFilters in the lab to review network traffic.

### Conclusion

In this lab, you will perform static and dynamic malware analysis using common tools such as VirusTotal, Wireshark, strings, and other tools used to investigate malware.